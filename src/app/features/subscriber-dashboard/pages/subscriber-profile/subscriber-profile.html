<div class="page-container">

  <div *ngIf="loading">{{ t('loading') }}</div>
  <div *ngIf="errorMsg" class="error">{{ errorMsg }}</div>

  <!-- Card 1: Company -->
  <div class="card">
    <div class="card-header">
      <div class="title-group">
        <div class="icon-box green-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M6 3C6 2.20435 6.31607 1.44129 6.87868 0.87868C7.44129 0.316071 8.20435 0 9 0H17C17.7956 0 18.5587 0.316071 19.1213 0.87868C19.6839 1.44129 20 2.20435 20 3V17C20 17.7956 19.6839 18.5587 19.1213 19.1213C18.5587 19.6839 17.7956 20 17 20H9C8.20435 20 7.44129 19.6839 6.87868 19.1213C6.31607 18.5587 6 17.7956 6 17V3ZM9 2C8.73478 2 8.48043 2.10536 8.29289 2.29289C8.10536 2.48043 8 2.73478 8 3V17C8 17.2652 8.10536 17.5196 8.29289 17.7071C8.48043 17.8946 8.73478 18 9 18H17C17.2652 18 17.5196 17.8946 17.7071 17.7071C17.8946 17.5196 18 17.2652 18 17V3C18 2.73478 17.8946 2.48043 17.7071 2.29289C17.5196 2.10536 17.2652 2 17 2H9Z"
              fill="#047857" />
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M0 9C0 8.20435 0.316071 7.44129 0.87868 6.87868C1.44129 6.31607 2.20435 6 3 6H7.5V8H3C2.73478 8 2.48043 8.10536 2.29289 8.29289C2.10536 8.48043 2 8.73478 2 9V17C2 17.2652 2.10536 17.5196 2.29289 17.7071C2.48043 17.8946 2.73478 18 3 18H12.5V20H3C2.20435 20 1.44129 19.6839 0.87868 19.1213C0.316071 18.5587 0 17.7956 0 17V9Z"
              fill="#047857" />
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M10 15C10 14.4696 10.2107 13.9609 10.5858 13.5858C10.9609 13.2107 11.4696 13 12 13H14C14.5304 13 15.0391 13.2107 15.4142 13.5858C15.7893 13.9609 16 14.4696 16 15V18H14V15H12V18H10V15Z"
              fill="#047857" />
            <path
              d="M10 4C10 3.73478 10.1054 3.48043 10.2929 3.29289C10.4804 3.10536 10.7348 3 11 3C11.2652 3 11.5196 3.10536 11.7071 3.29289C11.8946 3.48043 12 3.73478 12 4V5C12 5.26522 11.8946 5.51957 11.7071 5.70711C11.5196 5.89464 11.2652 6 11 6C10.7348 6 10.4804 5.89464 10.2929 5.70711C10.1054 5.51957 10 5.26522 10 5V4ZM10 9C10 8.73478 10.1054 8.48043 10.2929 8.29289C10.4804 8.10536 10.7348 8 11 8C11.2652 8 11.5196 8.10536 11.7071 8.29289C11.8946 8.48043 12 8.73478 12 9V10C12 10.2652 11.8946 10.5196 11.7071 10.7071C11.5196 10.8946 11.2652 11 11 11C10.7348 11 10.4804 10.8946 10.2929 10.7071C10.1054 10.5196 10 10.2652 10 10V9ZM3 13C3 12.7348 3.10536 12.4804 3.29289 12.2929C3.48043 12.1054 3.73478 12 4 12C4.26522 12 4.51957 12.1054 4.70711 12.2929C4.89464 12.4804 5 12.7348 5 13V14C5 14.2652 4.89464 14.5196 4.70711 14.7071C4.51957 14.8946 4.26522 15 4 15C3.73478 15 3.48043 14.8946 3.29289 14.7071C3.10536 14.5196 3 14.2652 3 14V13ZM14 4C14 3.73478 14.1054 3.48043 14.2929 3.29289C14.4804 3.10536 14.7348 3 15 3C15.2652 3 15.5196 3.10536 15.7071 3.29289C15.8946 3.48043 16 3.73478 16 4V5C16 5.26522 15.8946 5.51957 15.7071 5.70711C15.5196 5.89464 15.2652 6 15 6C14.7348 6 14.4804 5.89464 14.2929 5.70711C14.1054 5.51957 14 5.26522 14 5V4ZM14 9C14 8.73478 14.1054 8.48043 14.2929 8.29289C14.4804 8.10536 14.7348 8 15 8C15.2652 8 15.5196 8.10536 15.7071 8.29289C15.8946 8.48043 16 8.73478 16 9V10C16 10.2652 15.8946 10.5196 15.7071 10.7071C15.5196 10.8946 15.2652 11 15 11C14.7348 11 14.4804 10.8946 14.2929 10.7071C14.1054 10.5196 14 10.2652 14 10V9Z"
              fill="#047857" />
          </svg>
        </div>
        <h2>{{ t('companyInformation') }}</h2>
      </div>
    </div>

    <div class="form-grid">
      <div class="form-group">
        <label>{{ t('companyName') }}</label>
        <div class="read-only-field">{{ companyInfo.name }}</div>
      </div>
      <div class="form-group">
        <label>{{ t('companyEmail') }}</label>
        <div class="read-only-field">{{ companyInfo.email }}</div>
      </div>
      <div class="form-group">
        <label>{{ t('country') }}</label>
        <div class="read-only-field">{{ companyInfo.country }}</div>
      </div>
      <div class="form-group">
        <label>{{ t('city') }}</label>
        <div class="read-only-field">{{ companyInfo.city }}</div>
      </div>
    </div>
  </div>

  <!-- Card 2: License -->
  <div class="card">
    <div class="card-header">
      <div class="title-group">
        <div class="icon-box green-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
            <g clip-path="url(#clip0_1005_10552)">
              <path
                d="M21.333 4H2.66634C2.31272 4 1.97358 4.14048 1.72353 4.39052C1.47348 4.64057 1.33301 4.97971 1.33301 5.33333V18.6667C1.33301 19.0203 1.47348 19.3594 1.72353 19.6095C1.97358 19.8595 2.31272 20 2.66634 20H12.6663L13.0463 19.5333L13.6663 18.7733L13.6063 18.6667H2.66634V5.33333H21.333V11.04C21.8396 11.3678 22.2898 11.7752 22.6663 12.2467V5.33333C22.6663 4.97971 22.5259 4.64057 22.2758 4.39052C22.0258 4.14048 21.6866 4 21.333 4Z"
                fill="#047857" />
              <path d="M4.66602 8H15.9993V9.3H4.66602V8Z" fill="#047857" />
              <path d="M4.66602 10.6667H11.9993V11.9667H4.66602V10.6667Z" fill="#047857" />
              <path d="M4.66602 15.3333H11.3327V16.6333H4.66602V15.3333Z" fill="#047857" />
              <path
                d="M18.3069 11.4867C17.4538 11.4799 16.6184 11.7306 15.9101 12.2061C15.2017 12.6816 14.6533 13.3597 14.3365 14.1518C14.0196 14.944 13.9491 15.8132 14.1341 16.6461C14.3191 17.4789 14.7511 18.2366 15.3735 18.82L14.0802 20.4L14.6802 22.8067L17.1202 19.8333C17.8926 20.0617 18.7145 20.0617 19.4869 19.8333L21.9269 22.8067L22.5269 20.4L21.2335 18.82C21.856 18.2366 22.2879 17.4789 22.473 16.6461C22.658 15.8132 22.5875 14.944 22.2706 14.1518C21.9538 13.3597 21.4053 12.6816 20.697 12.2061C19.9886 11.7306 19.1533 11.4799 18.3002 11.4867H18.3069ZM18.3069 18.6067C17.7404 18.5988 17.1888 18.4236 16.7216 18.1031C16.2544 17.7826 15.8923 17.3312 15.6809 16.8055C15.4696 16.2798 15.4184 15.7034 15.5337 15.1487C15.6491 14.594 15.9258 14.0857 16.3292 13.6879C16.7326 13.29 17.2446 13.0203 17.8009 12.9126C18.3571 12.805 18.9328 12.8642 19.4555 13.0828C19.9782 13.3014 20.4246 13.6696 20.7386 14.1412C21.0526 14.6129 21.2202 15.1668 21.2202 15.7333C21.2132 16.5002 20.9027 17.233 20.3567 17.7714C19.8107 18.3099 19.0737 18.6102 18.3069 18.6067Z"
                fill="#047857" />
            </g>
            <defs>
              <clipPath id="clip0_1005_10552">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </div>
        <h2>{{ t('licenseInformation') }}</h2>
      </div>
    </div>

    <div class="form-grid">
      <div class="form-group">
        <label>{{ t('licenseName') }}</label>
        <div class="read-only-field">{{ licenseInfo.name }}</div>
      </div>
      <div class="form-group">
        <label>{{ t('licenseType') }}</label>
        <div class="read-only-field">{{ licenseInfo.type }}</div>
      </div>
      <div class="form-group">
        <label>{{ t('licenseNumber') }}</label>
        <div class="read-only-field">{{ licenseInfo.number }}</div>
      </div>
      <div class="form-group">
        <label>{{ t('licenseDate') }}</label>
        <div class="read-only-field">{{ licenseInfo.date }}</div>
      </div>
    </div>
  </div>

  <!-- Card 3: Subscription -->
  <div class="card">
    <div class="card-header">
      <div class="title-group">
        <div class="icon-box green-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="18" viewBox="0 0 22 18" fill="none">
            <path
              d="M0.75 8.75C0.75 4.979 0.75 3.093 1.922 1.922C3.094 0.751 4.979 0.75 8.75 0.75H12.75C16.521 0.75 18.407 0.75 19.578 1.922C20.749 3.094 20.75 4.979 20.75 8.75C20.75 12.521 20.75 14.407 19.578 15.578C18.406 16.749 16.521 16.75 12.75 16.75H8.75C4.979 16.75 3.093 16.75 1.922 15.578C0.751 14.406 0.75 12.521 0.75 8.75Z"
              stroke="#047857" stroke-width="1.5" />
            <path d="M8.75 12.75H4.75M12.75 12.75H11.25M0.75 6.75H20.75"
              stroke="#047857" stroke-width="1.5" stroke-linecap="round" />
          </svg>
        </div>
        <h2>{{ t('subscriptionDetails') }}</h2>
      </div>

      <a [routerLink]="'/subscriber/upgrade'">
        <button class="btn-upgrade">{{ t('upgradePlan') }}</button>
      </a>
    </div>

    <div class="details-grid">
      <div class="detail-item">
        <label>{{ t('currentPlan') }}</label>
        <span class="detail-value">{{ subscriptionDetails.currentPlan }}</span>
      </div>
      <div class="detail-item">
        <label>{{ t('status') }}</label>
        <span class="detail-value">{{ subscriptionDetails.status }}</span>
      </div>
      <div class="detail-item">
        <label>{{ t('startDate') }}</label>
        <span class="detail-value">{{ subscriptionDetails.startDate }}</span>
      </div>
      <div class="detail-item">
        <label>{{ t('endDate') }}</label>
        <span class="detail-value">{{ subscriptionDetails.endDate }}</span>
      </div>
      <div class="detail-item">
        <label>{{ t('paidFees') }}</label>
        <span class="detail-value">{{ subscriptionDetails.paidFees }} {{ t('sar') }}</span>
      </div>
      <div class="detail-item">
        <label>{{ t('remainingDays') }}</label>
        <span class="detail-value">{{ subscriptionDetails.remainingDays }}</span>
      </div>
    </div>

    <div class="usage-grid">
      <!-- Users -->
      <div class="usage-item">
        <div class="usage-header"><label>{{ t('users') }}</label></div>
        <div class="usage-value">
          {{ subscriptionDetails.usageBars.users.current }}/{{ subscriptionDetails.usageBars.users.max }}
          ({{ subscriptionDetails.usageBars.users.pct }}%)
        </div>
        <div class="progress-track">
          <div class="progress-fill"
               [style.width]="calculateWidth(subscriptionDetails.usageBars.users.current, subscriptionDetails.usageBars.users.max)">
          </div>
        </div>
      </div>

      <!-- Branches -->
      <div class="usage-item">
        <div class="usage-header"><label>{{ t('branches') }}</label></div>
        <div class="usage-value">
          {{ subscriptionDetails.usageBars.branches.current }}/{{ subscriptionDetails.usageBars.branches.max }}
          ({{ subscriptionDetails.usageBars.branches.pct }}%)
        </div>
        <div class="progress-track">
          <div class="progress-fill"
               [style.width]="calculateWidth(subscriptionDetails.usageBars.branches.current, subscriptionDetails.usageBars.branches.max)">
          </div>
        </div>
      </div>

      <!-- Clients -->
      <div class="usage-item">
        <div class="usage-header"><label>{{ t('clients') }}</label></div>
        <div class="usage-value">
          {{ subscriptionDetails.usageBars.clients.current }}/{{ subscriptionDetails.usageBars.clients.max }}
          ({{ subscriptionDetails.usageBars.clients.pct }}%)
        </div>
        <div class="progress-track">
          <div class="progress-fill"
               [style.width]="calculateWidth(subscriptionDetails.usageBars.clients.current, subscriptionDetails.usageBars.clients.max)">
          </div>
        </div>
      </div>

      <!-- Storage -->
      <div class="usage-item">
        <div class="usage-header"><label>{{ t('storage') }}</label></div>
        <div class="usage-value">
          {{ subscriptionDetails.usageBars.storage.current }} {{ subscriptionDetails.usageBars.storage.label }}
          / {{ subscriptionDetails.usageBars.storage.max }} {{ subscriptionDetails.usageBars.storage.label }}
          ({{ subscriptionDetails.usageBars.storage.pct }}%)
        </div>
        <div class="progress-track">
          <div class="progress-fill"
               [style.width]="calculateWidth(subscriptionDetails.usageBars.storage.current, subscriptionDetails.usageBars.storage.max)">
          </div>
        </div>
      </div>
    </div>

    <div class="plan-description">
      <label>{{ t('planDescription') }}</label>
      <p>{{ subscriptionDetails.description }}</p>
    </div>
  </div>

  <!-- Card 4: Links -->
  <div class="card">
    <div class="card-header">
      <div class="title-group">
        <div class="icon-box green-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M7.956 1.932C6.20485 2.48676 4.65852 3.55034 3.51409 4.9872C2.36966 6.42406 1.67896 8.16913 1.53 10H6.01C6.043 8.904 6.145 7.824 6.315 6.8C6.522 5.546 6.83 4.39 7.225 3.4C7.42496 2.8901 7.66958 2.39885 7.956 1.932ZM10.75 0C9.33829 -2.10361e-08 7.9404 0.278057 6.63615 0.818295C5.3319 1.35853 4.14683 2.15037 3.1486 3.1486C2.15037 4.14683 1.35853 5.3319 0.818295 6.63615C0.278057 7.9404 0 9.33829 0 10.75C0 12.1617 0.278057 13.5596 0.818295 14.8638C1.35853 16.1681 2.15037 17.3532 3.1486 18.3514C4.14683 19.3496 5.3319 20.1415 6.63615 20.6817C7.9404 21.2219 9.33829 21.5 10.75 21.5C13.6011 21.5 16.3354 20.3674 18.3514 18.3514C20.3674 16.3354 21.5 13.6011 21.5 10.75C21.5 7.89892 20.3674 5.16462 18.3514 3.1486C16.3354 1.13259 13.6011 4.24844e-08 10.75 0ZM10.75 1.5C10.489 1.5 10.151 1.626 9.759 2.032C9.363 2.442 8.968 3.083 8.618 3.957C8.271 4.826 7.988 5.874 7.794 7.046C7.639 7.986 7.544 8.983 7.512 10H13.988C13.9591 9.0102 13.8649 8.02339 13.706 7.046C13.512 5.874 13.229 4.826 12.882 3.957C12.532 3.083 12.137 2.442 11.742 2.032C11.349 1.626 11.012 1.5 10.75 1.5ZM15.49 10C15.46 8.92772 15.3581 7.85865 15.185 6.8C14.978 5.546 14.67 4.39 14.275 3.4C14.0747 2.89006 13.8298 2.39882 13.543 1.932C14.957 2.37923 16.2425 3.16022 17.291 4.209C18.8422 5.76064 19.7914 7.81315 19.969 10H15.49ZM13.988 11.5H7.512C7.543 12.517 7.639 13.514 7.794 14.454C7.988 15.626 8.271 16.674 8.618 17.543C8.968 18.417 9.363 19.058 9.758 19.468C10.151 19.874 10.488 20 10.75 20C11.011 20 11.349 19.874 11.741 19.468C12.137 19.058 12.532 18.417 12.882 17.543C13.229 16.674 13.512 15.626 13.706 14.454C13.861 13.514 13.956 12.517 13.988 11.5ZM13.544 19.568C13.814 19.134 14.059 18.639 14.274 18.1C14.67 17.11 14.978 15.954 15.185 14.7C15.3577 13.6413 15.4593 12.5723 15.489 11.5H19.969C19.82 13.3309 19.1293 15.0759 17.9849 16.5128C16.8405 17.9497 15.2952 19.0132 13.544 19.568ZM7.955 19.568C7.66892 19.1011 7.42464 18.6099 7.225 18.1C6.829 17.11 6.521 15.954 6.314 14.7C6.14127 13.6413 6.03971 12.5723 6.01 11.5H1.53C1.67888 13.3308 2.36944 15.0757 3.51368 16.5126C4.65792 17.9494 6.20404 19.0131 7.955 19.568Z"
              fill="#047857" />
          </svg>
        </div>
        <h2>{{ t('officialLinks') }}</h2>
      </div>
    </div>

    <div class="form-grid">
      <div class="form-group">
        <label>{{ t('cpa') }}</label>
        <div class="read-only-field link-text">
          <a *ngIf="authorityLinks.cpa" [href]="authorityLinks.cpa" target="_blank" rel="noopener">
            {{ authorityLinks.cpa }}
          </a>
          <span *ngIf="!authorityLinks.cpa">{{ t('dash') }}</span>
        </div>
      </div>

      <div class="form-group">
        <label>{{ t('taxZatca') }}</label>
        <div class="read-only-field link-text">
          <a *ngIf="authorityLinks.tax" [href]="authorityLinks.tax" target="_blank" rel="noopener">
            {{ authorityLinks.tax }}
          </a>
          <span *ngIf="!authorityLinks.tax">{{ t('dash') }}</span>
        </div>
      </div>

      <div class="form-group">
        <label>{{ t('ministryOfCommerce') }}</label>
        <div class="read-only-field link-text">
          <a *ngIf="authorityLinks.ministry" [href]="authorityLinks.ministry" target="_blank" rel="noopener">
            {{ authorityLinks.ministry }}
          </a>
          <span *ngIf="!authorityLinks.ministry">{{ t('dash') }}</span>
        </div>
      </div>
    </div>
  </div>

</div>
